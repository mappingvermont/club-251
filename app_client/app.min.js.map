{"version":3,"sources":["app.min.js"],"names":["config","$routeProvider","$locationProvider","when","templateUrl","controller","controllerAs","otherwise","redirectTo","html5Mode","run","$rootScope","$location","$http","authentication","$on","event","nextRoute","currentRoute","path","isLoggedIn","angular","module","homeCtrl","meanUsers","console","log","vm","this","users","getUsers","success","data","error","e","$inject","profileCtrl","$scope","$compile","leafletData","meanData","extend","vermont","lat","lng","zoom","defaults","scrollWheelZoom","user","getProfile","joinTopoJson","messageClick","town","status","fips6","leafletObject","_popup","_source","feature","properties","leafletEvent","popup","options","newScope","$new","stream","name","status_options","_contentNode","userData","getMap","then","map","topoJSONlayer","omnivore","topojson","on","eachLayer","layer","towns","style_poly","buildPopup","addTo","style_color","styles","setStyle","color","fill","weight","divNode","document","createElement","innerHTML","bindPopup","maxWidth","autoPan","Not yet","FARM","BROOK","POND","Tie","other","userCtrl","$routeParams","username","singleUser","loginCtrl","credentials","email","password","onSubmit","login","err","alert","populateTowns","fips6_list","i","length","registerCtrl","register","$window","saveToken","token","localStorage","getToken","payload","split","atob","JSON","parse","exp","Date","now","currentUser","post","logout","removeItem","service","get","headers","Authorization","navigationCtrl","navigation","restrict","directive"],"mappings":"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","file":"app.min.js","sourcesContent":["(function () {\n\n  angular.module('meanApp', ['ngRoute', 'leaflet-directive']);\n\n  function config ($routeProvider, $locationProvider) {\n    $routeProvider\n      .when('/', {\n        templateUrl: 'home/home.view.html',\n        controller: 'homeCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/register', {\n        templateUrl: '/auth/register/register.view.html',\n        controller: 'registerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/login', {\n        templateUrl: '/auth/login/login.view.html',\n        controller: 'loginCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/profile', {\n        templateUrl: '/profile/profile.view.html',\n        controller: 'profileCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/users/:username', {\n        templateUrl: '/users/users.view.html',\n        controller: 'userCtrl',\n        controllerAs: 'vm'\n      })\n      .otherwise({redirectTo: '/'});\n\n    // use the HTML5 History API\n    $locationProvider.html5Mode(true);\n  }\n\n  function run($rootScope, $location, $http, authentication) {\n    $rootScope.$on('$routeChangeStart', function(event, nextRoute, currentRoute) {\n      if ($location.path() === '/profile' && !authentication.isLoggedIn()) {\n        $location.path('/');\n      }\n    });\n  }\n  \n  angular\n    .module('meanApp')\n    .config(['$routeProvider', '$locationProvider', config])\n    .run(['$rootScope', '$location', '$http', 'authentication', run]);\n\n})();\n(function() {\n  \n  angular\n    .module('meanApp')\n    .controller('homeCtrl', homeCtrl);\n\n  homeCtrl.$inject = ['$location', 'meanUsers'];\n  function homeCtrl($location, meanUsers) {\n  \tconsole.log('Home controller is running');\n  \tconsole.log('And here');\n\n    var vm = this;\n    vm.users = []\n\n    meanUsers.getUsers()\n      .success(function(data) {\n        vm.users = data;\n        // console.log(data);\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n\n  }\n\n})();\n(function() {\n\n    angular\n        .module('meanApp')\n        .controller('profileCtrl', profileCtrl);\n\n\n    profileCtrl.$inject = ['$location', '$scope', '$compile', 'leafletData', 'meanData'];\n\n    function profileCtrl($location, $scope, $compile, leafletData, meanData) {\n\n        angular.extend($scope, {\n            vermont: {\n                lat: 43.9,\n                lng: -72.4,\n                zoom: 8\n            },\n            defaults: {\n                scrollWheelZoom: false\n            }\n        });\n\n\n        var vm = this;\n\n        vm.user = {};\n\n        meanData.getProfile()\n            .success(function(data) {\n                joinTopoJson(data, vm, leafletData)\n\n            })\n            .error(function(e) {\n                console.log(e);\n            });\n\n        $scope.messageClick = function(town) {\n            console.log(town)\n              console.log('option ' + town.status + ' selected for ' + town.fips6 + '!');\n\n            town.leafletObject._popup._source.feature.properties.status = town.status\n\n            };\n\n        $scope.$on('leafletDirectiveMap.popupopen', function(event, leafletEvent) {\n\n            // Create the popup view when is opened\n            var feature = leafletEvent.leafletEvent.popup.options.feature;\n\n            var properties = leafletEvent.leafletObject._popup._source.feature.properties\n\n            var newScope = $scope.$new();\n            newScope.stream = feature;\n\n            newScope.town = {}\n\n            newScope.town.name = properties.town\n            newScope.town.fips6 = properties.fips6\n            newScope.town.status = properties.status\n            newScope.town.status_options = ['Not yet', 'driving', 'walking']\n            newScope.town.leafletObject = leafletEvent.leafletObject\n            \n            $compile(leafletEvent.leafletEvent.popup._contentNode)(newScope);\n\n        });\n\n    }\n\n    function joinTopoJson(userData, vm, leafletData) {\n\n        leafletData.getMap().then(function(map) {\n            var topoJSONlayer = omnivore.topojson('../data/towns.json')\n\n            //$scope.data = userData\n\n            .on('ready', function() {\n\n                //$scope.data.status_options = ['Not yet', 'biking', 'driving']\n\n                topoJSONlayer.eachLayer(function(layer) {\n\n                    //$scope.layer = layer\n                    //console.log($scope.layer)\n                    console.log(userData)\n\n                    var fips6 = layer.feature.properties.fips6\n                    //$scope.layer.feature.properties.status = userData.towns[fips6]\n                    layer.feature.properties.status = userData.towns[fips6]\n                    //console.log(layer.feature.properties)\n\n                    style_poly(layer)\n\n                    buildPopup(layer.feature, layer);\n\n                });\n            })\n\n            .addTo(map);\n\n        });\n\n        vm.user = userData\n        console.log(vm.user)\n\n    }\n\n    var styles = {\n        'Not yet': '#4daf4a',\n        'FARM': '#e41a1c',\n        'BROOK': '#377eb8',\n        'POND': '#984ea3',\n        'Tie': '#999999',\n        'other': '#ff7f00'\n\n    }\n\n    function style_poly(layer) {\n\n        var style_color = (styles[layer.feature.properties.status] || styles['other']);\n\n        console.log('styling')\n\n        layer.setStyle({\n            color: style_color,\n            fill: style_color,\n            weight: 1,\n        })\n    }\n\n    function buildPopup(feature, layer) {\n\n        var divNode = document.createElement('DIV');\n\n        var popup = \"<div class='popup_box_header'>{{town.name}}<strong></strong></div><hr />\"\n        popup += '<select ng-model=\"town.status\" ng-change=messageClick(town) ng-options=\"v for v in town.status_options\"></select>'\n        popup += '</select>'\n\n        divNode.innerHTML = popup\n        layer.bindPopup(divNode, {\n            maxWidth: 450,\n            autoPan: true\n        })\n\n    }\n\n\n})();\n(function() {\n  \n  angular\n    .module('meanApp')\n    .controller('userCtrl', userCtrl);\n\n  userCtrl.$inject = ['$location', '$routeParams', 'meanUsers'];\n  function userCtrl($location, $routeParams, meanUsers) {\n    console.log('in users.controller.js')\n    var username = $routeParams.username\n    var vm = this;\n\n    vm.towns = {};\n\n    meanUsers.singleUser(username)\n      .success(function(data) {\n        vm.towns = data;\n        console.log('town data:')\n        console.log(data);\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n  }\n\n})();\n(function () {\n\n  angular\n  .module('meanApp')\n  .controller('loginCtrl', loginCtrl);\n\n  loginCtrl.$inject = ['$location', 'authentication'];\n  function loginCtrl($location, authentication) {\n    var vm = this;\n\n    vm.credentials = {\n      email : \"\",\n      password : \"\"\n    };\n\n    vm.onSubmit = function () {\n      authentication\n        .login(vm.credentials)\n        .error(function(err){\n          alert(err);\n        })\n        .then(function(){\n          $location.path('profile');\n        });\n    };\n\n  }\n\n})();\n(function () {\n\n  angular\n    .module('meanApp')\n    .controller('registerCtrl', registerCtrl);\n\n  function populateTowns(){\n    var fips6_list = [9030,11040,11015,11050,11060,13005,9080,9005,19050,19060,19085,9060,13015,9010,9095,9090,11075,19070,9065,11080,13020,11020,19090,19020,11070,19015,11030,9015,9020,19055,19065,11010,11065,19095,9045,9025,15005,11045,19005,13010,15045,11025,5040,11035,19010,5070,19040,7050,9040,19030,15010,5060,13025,9050,19045,5010,7080,15030,15050,7075,5085,9055,9085,15025,15035,5025,5065,5030,15040,15020,5035,5075,9070,7045,5055,9035,23095,23100,7005,5080,23025,7060,5005,23050,5045,23030,7020,7040,23090,23045,23035,23060,23055,1095,5020,23070,1060,23040,23015,1025,23010,7010,17040,23005,1015,17060,1100,1065,1075,1105,1050,17075,1005,17025,1110,17020,1055,1080,1010,1020,17070,17080,17030,1040,17065,1085,27075,1090,17050,27020,17055,27080,1070,21075,27085,27095,27055,27015,21005,27040,21047,27025,21135,21035,27045,27060,21110,27070,27115,21125,21060,21070,27050,21030,21065,27105,27005,27090,3045,3015,3030,3020,25050,25030,25110,3050,3075,3025,25045,25080,25095,3005,3070,25075,25015,25090,3060,3018,25073,25065,25060,25020,25025,3010,3080,3055,25105,25055,25010,3040,3035,3065,25100,25040,25035,25085,11055,15015,9075,7025,5015,7090,23020,7065,7055,7035,27065,27120,21095,7015,17010,17045,7030,5050,17035,7070,7085,17085,17015,17005,21085,21120,21130,21055,27110,27035,27030,27011,27100,19080,19035,19025,19075,23065,23080,25070,25005,1035,23075,23085,1030,1115,1045,21020,21115,21040,21015,21045,21010,21080,21140,21090,21100,21050,21025]\n    \n    var towns = {}\n\n    for (i=0; i < fips6_list.length; i++) {\n      towns[fips6_list[i]] = 'Not yet'\n    }\n\n    return towns\n  }\n\n  registerCtrl.$inject = ['$location', 'authentication'];\n  function registerCtrl($location, authentication) {\n    var vm = this;\n\n    var fips6_list = []\n\n    vm.credentials = {\n      name : \"\",\n      email : \"\",\n      password : \"\",\n      towns: populateTowns()\n    };\n\n    vm.onSubmit = function () {\n      console.log('Submitting registration');\n      console.log(vm.credentials);\n      authentication\n        .register(vm.credentials)\n        .error(function(err){\n          alert(err);\n        })\n        .then(function(){\n          $location.path('profile');\n        });\n    };\n\n  }\n\n})();\n(function () {\n\n  angular\n    .module('meanApp')\n    .service('authentication', authentication);\n\n  authentication.$inject = ['$http', '$window'];\n  function authentication ($http, $window) {\n\n    var saveToken = function (token) {\n      $window.localStorage['mean-token'] = token;\n    };\n\n    var getToken = function () {\n      return $window.localStorage['mean-token'];\n    };\n\n    var isLoggedIn = function() {\n      var token = getToken();\n      var payload;\n\n      if(token){\n        payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n\n        return payload.exp > Date.now() / 1000;\n      } else {\n        return false;\n      }\n    };\n\n    var currentUser = function() {\n      if(isLoggedIn()){\n        var token = getToken();\n        var payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n        return {\n          email : payload.email,\n          name : payload.name\n        };\n      }\n    };\n\n    register = function(user) {\n      return $http.post('/api/register', user).success(function(data){\n        console.log('registering user!')\n        console.log(data)\n        saveToken(data.token);\n      });\n    };\n\n    login = function(user) {\n      return $http.post('/api/login', user).success(function(data) {\n        saveToken(data.token);\n      });\n    };\n\n    logout = function() {\n      $window.localStorage.removeItem('mean-token');\n    };\n\n    return {\n      currentUser : currentUser,\n      saveToken : saveToken,\n      getToken : getToken,\n      isLoggedIn : isLoggedIn,\n      register : register,\n      login : login,\n      logout : logout\n    };\n  }\n\n\n})();\n(function() {\n\n  angular\n    .module('meanApp')\n    .service('meanData', meanData);\n\n  meanData.$inject = ['$http', 'authentication'];\n  function meanData ($http, authentication) {\n\n    var getProfile = function () {\n      return $http.get('/api/profile', {\n        headers: {\n          Authorization: 'Bearer '+ authentication.getToken()\n        }\n      });\n    };\n\n    return {\n      getProfile : getProfile\n    };\n  }\n\n})();\n(function() {\n\n  angular\n    .module('meanApp')\n    .service('meanUsers', meanUsers);\n\n  meanUsers.$inject = ['$http', 'authentication'];\n\n  function meanUsers ($http, authentication) {\n\n    var getUsers = function () {\n      console.log('calling find all users')\n      return $http.get('/api/users', {\n      });\n    };\n\n    var singleUser = function (username) {\n      console.log('calling singleUser for: ' + username)\n      return $http.get('/api/users/' + username, {\n      });\n    };\n\n    return {\n      getUsers : getUsers,\n      singleUser : singleUser\n    };\n  }\n\n})();\n(function () {\n\n  angular\n    .module('meanApp')\n    .controller('navigationCtrl', navigationCtrl);\n\n  navigationCtrl.$inject = ['$location','authentication'];\n  function navigationCtrl($location, authentication) {\n    var vm = this;\n\n    vm.isLoggedIn = authentication.isLoggedIn();\n\n    vm.currentUser = authentication.currentUser();\n\n  }\n\n})();\n(function () {\n\n  angular\n    .module('meanApp')\n    .directive('navigation', navigation);\n\n  function navigation () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/common/directives/navigation/navigation.template.html',\n      controller: 'navigationCtrl as navvm'\n    };\n  }\n\n})();"],"sourceRoot":"/source/"}