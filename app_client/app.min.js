!function(){function n(n,e){n.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/profile",{templateUrl:"/profile/profile.view.html",controller:"profileCtrl",controllerAs:"vm"}).when("/users/:username",{templateUrl:"/users/users.view.html",controller:"userCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"}),e.html5Mode(!0)}function e(n,e,o,t,r){n.$on("$routeChangeStart",function(n,o,r){"/profile"!==e.path()||t.isLoggedIn()||e.path("/")})}angular.module("meanApp",["ngRoute"]),angular.module("meanApp").config(["$routeProvider","$locationProvider",n]).run(["$rootScope","$location","$http","authentication","meanTopoJSON",e])}(),function(){function n(n,e){console.log("Home controller is running"),console.log("And here");var o=this;o.users=[],e.getUsers().success(function(n){o.users=n}).error(function(n){console.log(n)})}angular.module("meanApp").controller("homeCtrl",n),n.$inject=["$location","meanUsers"]}(),function(){function n(n,o,t,r){var i=this;i.user={},t.getProfile().success(function(o){r.promise.then(function(t){console.log("got topojson"),e(n,o,t,i)})}).error(function(n){console.log(n)})}function e(n,e,o,t){console.log("started join"),console.log(o);var r=o.data.objects.towns.geometries;for(i=0;i<r.length;i++){var l=r[i].properties.fips6;r[i].properties.status=e.towns[l]}console.log("finished join"),e.topojson=o,t.user=e,console.log(t.user)}angular.module("meanApp").controller("profileCtrl",n),n.$inject=["$http","$location","meanData","meanTopoJSON"]}(),function(){function n(n,e,o){console.log("in users.controller.js");var t=e.username,r=this;r.towns={},o.singleUser(t).success(function(n){r.towns=n,console.log("town data:"),console.log(n)}).error(function(n){console.log(n)})}angular.module("meanApp").controller("userCtrl",n),n.$inject=["$location","$routeParams","meanUsers"]}(),function(){function n(n,e){var o=this;o.credentials={email:"",password:""},o.onSubmit=function(){e.login(o.credentials).error(function(n){alert(n)}).then(function(){n.path("profile")})}}angular.module("meanApp").controller("loginCtrl",n),n.$inject=["$location","authentication"]}(),function(){function n(){var n=[9030,11040,11015,11050,11060,13005,9080,9005,19050,19060,19085,9060,13015,9010,9095,9090,11075,19070,9065,11080,13020,11020,19090,19020,11070,19015,11030,9015,9020,19055,19065,11010,11065,19095,9045,9025,15005,11045,19005,13010,15045,11025,5040,11035,19010,5070,19040,7050,9040,19030,15010,5060,13025,9050,19045,5010,7080,15030,15050,7075,5085,9055,9085,15025,15035,5025,5065,5030,15040,15020,5035,5075,9070,7045,5055,9035,23095,23100,7005,5080,23025,7060,5005,23050,5045,23030,7020,7040,23090,23045,23035,23060,23055,1095,5020,23070,1060,23040,23015,1025,23010,7010,17040,23005,1015,17060,1100,1065,1075,1105,1050,17075,1005,17025,1110,17020,1055,1080,1010,1020,17070,17080,17030,1040,17065,1085,27075,1090,17050,27020,17055,27080,1070,21075,27085,27095,27055,27015,21005,27040,21047,27025,21135,21035,27045,27060,21110,27070,27115,21125,21060,21070,27050,21030,21065,27105,27005,27090,3045,3015,3030,3020,25050,25030,25110,3050,3075,3025,25045,25080,25095,3005,3070,25075,25015,25090,3060,3018,25073,25065,25060,25020,25025,3010,3080,3055,25105,25055,25010,3040,3035,3065,25100,25040,25035,25085,11055,15015,9075,7025,5015,7090,23020,7065,7055,7035,27065,27120,21095,7015,17010,17045,7030,5050,17035,7070,7085,17085,17015,17005,21085,21120,21130,21055,27110,27035,27030,27011,27100,19080,19035,19025,19075,23065,23080,25070,25005,1035,23075,23085,1030,1115,1045,21020,21115,21040,21015,21045,21010,21080,21140,21090,21100,21050,21025],e={};for(i=0;i<n.length;i++)e[n[i]]=!1;return e}function e(e,o){var t=this;t.credentials={name:"",email:"",password:"",towns:n()},t.onSubmit=function(){console.log("Submitting registration"),console.log(t.credentials),o.register(t.credentials).error(function(n){alert(n)}).then(function(){e.path("profile")})}}angular.module("meanApp").controller("registerCtrl",e),e.$inject=["$location","authentication"]}(),function(){function n(n,e){var o=function(n){e.localStorage["mean-token"]=n},t=function(){return e.localStorage["mean-token"]},r=function(){var n,o=t();return!!o&&(n=o.split(".")[1],n=e.atob(n),n=JSON.parse(n),n.exp>Date.now()/1e3)},i=function(){if(r()){var n=t(),o=n.split(".")[1];return o=e.atob(o),o=JSON.parse(o),{email:o.email,name:o.name}}};return register=function(e){return n.post("/api/register",e).success(function(n){console.log("registering user!"),console.log(n),o(n.token)})},login=function(e){return n.post("/api/login",e).success(function(n){o(n.token)})},logout=function(){e.localStorage.removeItem("mean-token")},{currentUser:i,saveToken:o,getToken:t,isLoggedIn:r,register:register,login:login,logout:logout}}angular.module("meanApp").service("authentication",n),n.$inject=["$http","$window"]}(),function(){function n(n,e){var o=function(){return n.get("/api/profile",{headers:{Authorization:"Bearer "+e.getToken()}})};return{getProfile:o}}angular.module("meanApp").service("meanData",n),n.$inject=["$http","authentication"]}(),function(){function n(n){var e=n.get("data/towns.json").success(function(n){return n});return{promise:e}}angular.module("meanApp").service("meanTopoJSON",n),n.$inject=["$http"]}(),function(){function n(n,e){var o=function(){return console.log("calling find all users"),n.get("/api/users",{})},t=function(e){return console.log("calling singleUser for: "+e),n.get("/api/users/"+e,{})};return{getUsers:o,singleUser:t}}angular.module("meanApp").service("meanUsers",n),n.$inject=["$http","authentication"]}(),function(){function n(n,e){var o=this;o.isLoggedIn=e.isLoggedIn(),o.currentUser=e.currentUser()}angular.module("meanApp").controller("navigationCtrl",n),n.$inject=["$location","authentication"]}(),function(){function n(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}angular.module("meanApp").directive("navigation",n)}();
//# sourceMappingURL=app.min.js.map
